apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  annotations:
    # Setting olm.maxOpenShiftVersion automatically
    # This property was added via an automatic process since it was possible to identify that this distribution uses API(s),
    # which will be removed in the k8s version 1.22 and OpenShift version OCP 4.9. Then, it will prevent OCP users to
    # upgrade their cluster to 4.9 before they have installed in their current clusters a version of your operator that
    # is compatible with it. Please, ensure that your project is no longer using these API(s) and that you start to
    # distribute solutions which is compatible with Openshift 4.9.
    # For further information, check the README of this repository.
    olm.properties: '[{"type": "olm.maxOpenShiftVersion", "value": "4.8"}]'
    alm-examples: "[\n  {\n    \"apiVersion\": \"csi.ibm.com/v1\",\n    \"kind\":\
      \ \"CSIScaleOperator\",\n    \"metadata\": {\n      \"labels\": {\n        \"\
      app.kubernetes.io/instance\": \"ibm-spectrum-scale-csi-operator\",\n       \
      \ \"app.kubernetes.io/managed-by\": \"ibm-spectrum-scale-csi-operator\",\n \
      \       \"app.kubernetes.io/name\": \"ibm-spectrum-scale-csi-operator\"\n  \
      \    },\n      \"name\": \"ibm-spectrum-scale-csi\"\n    },\n    \"spec\": {\n\
      \      \"clusters\": [\n        {\n          \"id\": \"\\u003c Primary Cluster\
      \ ID - WARNING: THIS IS A STRING NEEDS YAML QUOTES!\\u003e\",\n          \"\
      primary\": {\n            \"primaryFs\": \"\\u003c Primary Filesystem \\u003e\"\
      ,\n            \"primaryFset\": \"\\u003c Fileset in Primary Filesystem \\u003e\"\
      \n          },\n          \"restApi\": [\n            {\n              \"guiHost\"\
      : \"\\u003c Primary cluster GUI IP/Hostname \\u003e\"\n            }\n     \
      \     ],\n          \"secrets\": \"secret1\",\n          \"secureSslMode\":\
      \ false\n        }\n      ],\n      \"scaleHostpath\": \"\\u003c GPFS FileSystem\
      \ Path \\u003e\"\n    },\n    \"status\": {}\n  }\n]"
    capabilities: Basic Install
    categories: Storage
    certified: 'false'
    containerImage: quay.io/ibm-spectrum-scale/ibm-spectrum-scale-csi-operator:v1.0.0
    createdAt: Wed Dec  4 06:41:31 EST 2019
    description: An operator for deploying and managing the IBM CSI Spectrum Scale Driver.
    repository: https://github.com/IBM/ibm-spectrum-scale-csi-operator/
    support: IBM
  labels:
    app.kubernetes.io/instance: ibm-spectrum-scale-csi-operator
    app.kubernetes.io/managed-by: ibm-spectrum-scale-csi-operator
    app.kubernetes.io/name: ibm-spectrum-scale-csi-operator
  name: ibm-spectrum-scale-csi-operator.v1.0.0
  namespace: placeholder
spec:
  apiservicedefinitions: {}
  customresourcedefinitions:
    owned:
    - description: Represents a deployment of the IBM CSI Spectrum Scale driver.
      displayName: IBM CSI Spectrum Scale Driver
      kind: CSIScaleOperator
      name: csiscaleoperators.csi.ibm.com
      resources:
      - kind: csiscaleoperators
        name: ''
        version: v1
      - kind: Deployment
        name: ''
        version: v1
      - kind: Secret
        name: ''
        version: v1
      - kind: Pod
        name: ''
        version: v1
      - kind: StatefulSet
        name: ''
        version: v1beta1
      - kind: DaemonSet
        name: ''
        version: v1beta2
      - kind: ConfigMap
        name: ''
        version: v1
      specDescriptors:
      - description: Node selector for provisioner sidecar.
        displayName: Provisioner Node Selector
        path: provisionerNodeSelector
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:advanced
      - description: Node selector for SpectrumScale CSI Plugin.
        displayName: Plugin Node Selector
        path: pluginNodeSelector
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:advanced
      - description: A collection of gpfs cluster properties for the csi driver to
          mount.
        displayName: Clusters
        path: clusters
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:advanced
      - description: Image name for the csi spectrum scale plugin container.
        displayName: Spectrum Scale Image
        path: spectrumScale
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: An internal counter used by the operator to trigger reloads on
          secret change.
        displayName: Secret Counter
        path: secretCounter
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:number
      - description: Mapping of K8s node with SpectrumScale node.
        displayName: nodeMapping
        path: nodeMapping
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Provisioner image for csi (actually issues provision requests).
        displayName: Provisioner Image
        path: provisioner
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Sidecar container image for the csi spectrum scale plugin pods.
        displayName: Driver Registrar Image
        path: driverRegistrar
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: The path to the gpfs file system mounted on the host machine.
        displayName: Spectrum Scale Hostpath
        path: scaleHostpath
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Attacher image for csi (actually attaches to the storage).
        displayName: Attacher Image
        path: attacher
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Node selector for attacher sidecar.
        displayName: Attacher Node Selector
        path: attacherNodeSelector
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:advanced
      - description: Key for node selector.
        displayName: Key
        path: provisionerNodeSelector.key
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Value for key.
        displayName: Value
        path: provisionerNodeSelector.value
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Key for node selector.
        displayName: Key
        path: pluginNodeSelector.key
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Value for key.
        displayName: Value
        path: pluginNodeSelector.value
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: A string specifying a cacert resource name.
        displayName: cacert Resource Name
        path: clusters.cacert
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Require a secure SSL connection to connect to GPFS.
        displayName: Secure SSL Mode
        path: clusters.secureSslMode
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:booleanSwitch
      - description: A string specifying a secret resource name.
        displayName: Kubernetes Secret Name
        path: clusters.secrets
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: A collection of targets for REST calls.
        displayName: REST API
        path: clusters.restApi
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:advanced
      - description: The primary file system for the GPFS cluster.
        displayName: Primary
        path: clusters.primary
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:advanced
      - description: The cluster id of the gpfs cluster specified (mandatory).
        displayName: ID
        path: clusters.id
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: K8s node name.
        displayName: Kubernetes Node
        path: nodeMapping.k8sNode
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: SpectrumScale node name.
        displayName: Spectrum Scale Node
        path: nodeMapping.spectrumscaleNode
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Key for node selector.
        displayName: Key
        path: attacherNodeSelector.key
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: Value for key.
        displayName: Value
        path: attacherNodeSelector.value
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: The hostname of the REST server.
        displayName: GUI Host
        path: clusters.restApi.guiHost
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:label
      - description: The port number running the REST server.
        displayName: GUI Port
        path: clusters.restApi.guiPort
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:number
      statusDescriptors:
      - description: The active status of the operator
        displayName: Conditions
        path: conditions
        x-descriptors:
        - urn:alm:descriptor:io.kubernetes.conditions
      - description: Indicates that the plugin is running.
        displayName: Is Running
        path: conditions.isRunning
        x-descriptors:
        - urn:alm:descriptor:io.kubernetes.phase
      version: v1
  description: "IBM Spectrum Scale CSI Operator Quickstart\n==========================================\n\
    \nThe IBM Spectrum Scale CSI Operator runs within a Kubernetes cluster providing\
    \ a means to \ndeploy and manage the CSI plugin for spectrum scale. For more in\
    \ depth documentation please refer\nto the [README](https://github.com/IBM/ibm-spectrum-scale-csi-operator/blob/v1.0.0/README.md).\n\
    \nThis operator should be used to deploy the CSI plugin.\n\nThe configuration\
    \ process is as follows:\n\n1. [Spectrum Scale GUI Setup](#spectrum-scale-gui-setup)\n\
    2. [Custom Resource Configuration](#custom-resource-configuration)\n\nSpectrum\
    \ Scale GUI Setup \n------------------------\n> **NOTE:** This step only needs\
    \ to be preformed once per GUI.\n\n> **WARNING:** If your daemonset pods (driver\
    \ pods) do not come up, generally this means you have a  secret that  has not\
    \ been defined in the correct namespace.\n\n1. Ensure the Spectrum Scale GUI is\
    \ running by pointing your browser to the IP hosting the GUI:\n\n    ![](https://user-images.githubusercontent.com/1195452/67230992-6d2d9700-f40c-11e9-96d5-3f0e5bcb2d9a.png)\n\
    \n    > If you do not see a login follow on screen instructions, or review the\
    \ [GUI Documentation](https://www.ibm.com/support/knowledgecenter/en/STXKQY_5.0.3/com.ibm.spectrum.scale.v5r03.doc/bl1ins_quickrefforgui.htm)\n\
    \n\n2. Create a CsiAdmin group account on in the GUI (currently requires a CLI\
    \ call):\n\n   ```\n\n   export USERNAME=\"SomeUser\"\n   export PASSWORD=\"SomePassword\"\
    \n   /usr/lpp/mmfs/gui/cli/mkuser ${USERNAME} -p ${PASSWORD} -g CsiAdmin\n\n \
    \  ```\n\n3. Create a Kubernetes secret for the `CsiAdmin` user:\n\n  ```\n\n\
    \  export USERNAME_B64=$(echo $USERNAME | base64)\n  export PASSWORD_B64=$(echo\
    \ $PASSWORD | base64)\n  export OPERATOR_NAMESPACE=\"ibm-spectrum-scale-csi-driver\"\
    \  # Set this to the namespace you deploy the operator in.\n  \n\n  cat << EOF\
    \ > /tmp/csisecret.yaml\n  apiVersion: v1\n  data:\n    password: ${PASSWORD_B64}\n\
    \    username: ${USERNAME_B64}\n  kind: Secret\n  type: Opaque\n  metadata:\n\
    \    name: csisecret    # This should be in your CSIScaleOperator definition\n\
    \    namespace: ${OPERATOR_NAMESPACE} \n    labels:\n      app.kubernetes.io/name:\
    \ ibm-spectrum-scale-csi-operator # Used by the operator to detect changes, set\
    \ on load of CR change if secret matches name in CR and namespace.\n  EOF\n  \n\
    \n  kubectl create -f /tmp/csisecret.yaml\n  rm -f /tmp/csisecret.yaml\n  \n \
    \ ```\n\nCustom Resource Configuration\n-----------------------------\n\nThe bundled\
    \ Custom Resource example represents the minimum settings needed to run the operator.\n\
    If your environment needs more advanced settings (e.g. remote clusters, node mapping,\
    \ etc.) please\nrefer to the sample [Custom Resource](https://github.com/IBM/ibm-spectrum-scale-csi-operator/blob/v1.0.0/stable/ibm-spectrum-scale-csi-operator-bundle/operators/ibm-spectrum-scale-csi-operator/deploy/crds/ibm-spectrum-scale-csi-operator-cr.yaml).\n\
    \n\n"
  displayName: IBM Spectrum Scale CSI Plugin Operator
  icon:
  - base64data: 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
    mediatype: image/png
  install:
    spec:
      clusterPermissions:
      - rules:
        - apiGroups:
          - security.openshift.io
          resources:
          - securitycontextconstraints
          verbs:
          - '*'
        - apiGroups:
          - ''
          resources:
          - secrets
          - secrets/status
          verbs:
          - '*'
        - apiGroups:
          - storage.k8s.io
          resources:
          - volumeattachments
          - storageclasses
          verbs:
          - '*'
        serviceAccountName: ibm-spectrum-scale-csi-operator
      - rules:
        - apiGroups:
          - ''
          resources:
          - nodes
          verbs:
          - get
          - list
          - update
        - apiGroups:
          - ''
          resources:
          - namespaces
          verbs:
          - get
          - list
        - apiGroups:
          - ''
          resources:
          - persistentvolumes
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - storage.k8s.io
          resources:
          - volumeattachments
          verbs:
          - get
          - list
          - watch
          - update
        serviceAccountName: ibm-spectrum-scale-csi-node
      - rules:
        - apiGroups:
          - ''
          resources:
          - events
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - ''
          resources:
          - persistentvolumes
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - ''
          resources:
          - nodes
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - storage.k8s.io
          resources:
          - volumeattachments
          verbs:
          - get
          - list
          - watch
          - update
        serviceAccountName: ibm-spectrum-scale-csi-attacher
      - rules:
        - apiGroups:
          - ''
          resources:
          - secrets
          verbs:
          - get
          - list
        - apiGroups:
          - ''
          resources:
          - persistentvolumes
          verbs:
          - get
          - list
          - watch
          - create
          - delete
        - apiGroups:
          - ''
          resources:
          - persistentvolumeclaims
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - storage.k8s.io
          resources:
          - storageclasses
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - ''
          resources:
          - events
          verbs:
          - list
          - watch
          - create
          - update
          - patch
        serviceAccountName: ibm-spectrum-scale-csi-provisioner
      deployments:
      - name: ibm-spectrum-scale-csi-operator
        spec:
          replicas: 1
          selector:
            matchLabels:
              app.kubernetes.io/name: ibm-spectrum-scale-csi-operator
          strategy: {}
          template:
            metadata:
              annotations:
                productID: ibm-spectrum-scale-csi-operator
                productName: IBM Spectrum Scale CSI Operator
                productVersion: 1.0.0
              labels:
                app.kubernetes.io/instance: ibm-spectrum-scale-csi-operator
                app.kubernetes.io/managed-by: ibm-spectrum-scale-csi-operator
                app.kubernetes.io/name: ibm-spectrum-scale-csi-operator
                name: ibm-spectrum-scale-csi-operator
                product: ibm-spectrum-scale-csi
            spec:
              affinity:
                nodeAffinity:
                  requiredDuringSchedulingIgnoredDuringExecution:
                    nodeSelectorTerms:
                    - matchExpressions:
                      - key: beta.kubernetes.io/arch
                        operator: Exists
              containers:
              - command:
                - /usr/local/bin/ao-logs
                - /tmp/ansible-operator/runner
                - stdout
                image: quay.io/ibm-spectrum-scale/ibm-spectrum-scale-csi-operator:v1.0.0
                imagePullPolicy: IfNotPresent
                name: ansible
                resources: {}
                securityContext:
                  capabilities:
                    drop:
                    - ALL
                volumeMounts:
                - mountPath: /tmp/ansible-operator/runner
                  name: runner
                  readOnly: true
              - env:
                - name: WATCH_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.annotations['olm.targetNamespaces']
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: OPERATOR_NAME
                  value: ibm-spectrum-scale-csi-operator
                image: quay.io/ibm-spectrum-scale/ibm-spectrum-scale-csi-operator:v1.0.0
                imagePullPolicy: IfNotPresent
                name: operator
                resources: {}
                securityContext:
                  capabilities:
                    drop:
                    - ALL
                volumeMounts:
                - mountPath: /tmp/ansible-operator/runner
                  name: runner
              serviceAccountName: ibm-spectrum-scale-csi-operator
              volumes:
              - emptyDir: {}
                name: runner
      permissions:
      - rules:
        - apiGroups:
          - ''
          resources:
          - pods
          - persistentvolumeclaims
          - services
          - endpoints
          - events
          - configmaps
          - secrets
          - secrets/status
          - services/finalizers
          verbs:
          - '*'
        - apiGroups:
          - apps
          resources:
          - deployments
          - daemonsets
          - replicasets
          - statefulsets
          verbs:
          - '*'
        - apiGroups:
          - monitoring.coreos.com
          resources:
          - servicemonitors
          verbs:
          - get
          - create
        - apiGroups:
          - apps
          resourceNames:
          - ibm-spectrum-scale-csi-operator
          resources:
          - deployments/finalizers
          verbs:
          - update
        - apiGroups:
          - apps
          resources:
          - replicasets
          verbs:
          - get
        - apiGroups:
          - csi.ibm.com
          resources:
          - '*'
          verbs:
          - '*'
        serviceAccountName: ibm-spectrum-scale-csi-operator
    strategy: deployment
  installModes:
  - supported: true
    type: OwnNamespace
  - supported: true
    type: SingleNamespace
  - supported: false
    type: MultiNamespace
  - supported: false
    type: AllNamespaces
  keywords:
  - IBM
  - GPFS
  - Spectrum Scale
  labels:
    operator: ibm-spectrum-scale-csi-operator
  links:
  - name: IBM CSI Spectrum Scale Operator Documentation
    url: https://ibm-spectrum-scale-csi-operator.readthedocs.io/en/latest/
  - name: CSI Developer Documentation
    url: https://kubernetes-csi.github.io/docs/
  maintainers:
  - email: jdunham@us.ibm.com
    name: John Dunham
  - email: yadayada@in.ibm.com
    name: Yadavendra Yadav
  maturity: alpha
  provider:
    name: IBM
  version: 1.0.0
