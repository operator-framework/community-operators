---
- name: "kafka : {{ 'create' if kafka.enabled == true else 'remove' }} service account"
  k8s:
    definition: "{{ lookup('template', 'kafka/serviceaccount.yaml') }}"
    state: "{{ 'present' if kafka.enabled == true else 'absent' }}"

- name: "kafka : {{ 'create' if kafka.enabled == true else 'remove' }} jmx configmap"
  k8s:
    definition: "{{ lookup('template', 'kafka/jmx-config.yaml') }}"
    state: "{{ 'present' if kafka.enabled == true else 'absent' }}"

- name: "kafka : {{ 'create' if kafka.enabled == true else 'remove' }} configmap"
  k8s:
    definition: "{{ lookup('template', 'kafka/configmap.yaml') }}"
    state: "{{ 'present' if kafka.enabled == true else 'absent' }}"
  register: kafka_configmap

- name: "kafka : {{ 'create' if kafka.enabled == true else 'remove' }} service"
  k8s:
    definition: "{{ lookup('template', 'kafka/service.yaml') }}"
    state: "{{ 'present' if kafka.enabled == true else 'absent' }}"

- name: "kafka : {{ 'create' if kafka.enabled == true else 'remove' }} cluster"
  k8s:
    definition: "{{ lookup('template', 'kafka/statefulset.yaml') }}"
    state: "{{ 'present' if kafka.enabled == true else 'absent' }}"
