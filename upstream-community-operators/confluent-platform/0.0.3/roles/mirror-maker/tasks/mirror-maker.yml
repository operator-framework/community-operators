---
- name: "mirror-maker : create service account"
  k8s:
    definition: "{{ lookup('template', 'mirror-maker/serviceaccount.yaml') }}"
    state: "present"

- name: "mirror-maker : create configmap"
  k8s:
    definition: "{{ lookup('template', 'mirror-maker/configmap.yaml') }}"
    state: "present"
  register: mirror_maker_configmap

#- name: "mirror-maker : {{ 'create' if mirror_maker.enabled == true else 'remove' }} service"
#  k8s:
#    definition: "{{ lookup('template', 'mirrormaker/service.yaml') }}"
#    state: "{{ 'present' if mirror_maker.enabled == true else 'absent' }}"

- name: "mirror-maker : create cluster"
  k8s:
    definition: "{{ lookup('template', 'mirror-maker/deployment.yaml') }}"
    state: "present"
